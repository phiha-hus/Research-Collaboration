%!PS-Adobe-2.0
%%DocumentFonts: Courier Times-Bold
%%Title: src.txt (mpage)
%%Creator: mpage 2.4 September 1996
%%CreationDate: Wed Dec  7 14:22:59 2005
%%Orientation: Portrait
%%DocumentMedia: A4 596 842
%%BoundingBox: 18 18 578 824
%%Pages: (atend)
%%EndComments

/mp_stm usertime def
/mp_pgc statusdict begin pagecount end def
statusdict begin /jobname (src.txt) def end
/reencsmalldict 12 dict def /ReEncodeSmall { reencsmalldict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq { exch dup length array copy newfont 3 1 roll put } { exch newfont 3 1 roll put }
ifelse }
  { pop pop }
  ifelse } forall
newfont /FontName newfontname put
newcodesandnames aload pop newcodesandnames length 2 idiv
{ newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/charvec [
026 /Scaron
027 /Ydieresis
028 /Zcaron
029 /scaron
030 /trademark
031 /zcaron
032 /space
033 /exclam
034 /quotedbl
035 /numbersign
036 /dollar
037 /percent
038 /ampersand
039 /quoteright
040 /parenleft
041 /parenright
042 /asterisk
043 /plus
044 /comma
045 /minus
046 /period
047 /slash
048 /zero
049 /one
050 /two
051 /three
052 /four
053 /five
054 /six
055 /seven
056 /eight
057 /nine
058 /colon
059 /semicolon
060 /less
061 /equal
062 /greater
063 /question
064 /at
065 /A
066 /B
067 /C
068 /D
069 /E
070 /F
071 /G
072 /H
073 /I
074 /J
075 /K
076 /L
077 /M
078 /N
079 /O
080 /P
081 /Q
082 /R
083 /S
084 /T
085 /U
086 /V
087 /W
088 /X
089 /Y
090 /Z
091 /bracketleft
092 /backslash
093 /bracketright
094 /asciicircum
095 /underscore
096 /quoteleft
097 /a
098 /b
099 /c
100 /d
101 /e
102 /f
103 /g
104 /h
105 /i
106 /j
107 /k
108 /l
109 /m
110 /n
111 /o
112 /p
113 /q
114 /r
115 /s
116 /t
117 /u
118 /v
119 /w
120 /x
121 /y
122 /z
123 /braceleft
124 /bar
125 /braceright
126 /asciitilde
127 /.notdef
128 /fraction
129 /florin
130 /quotesingle
131 /quotedblleft
132 /guilsinglleft
133 /guilsinglright
134 /fi
135 /fl
136 /endash
137 /dagger
138 /daggerdbl
139 /bullet
140 /quotesinglbase
141 /quotedblbase
142 /quotedblright
143 /ellipsis
144 /dotlessi
145 /grave
146 /acute
147 /circumflex
148 /tilde
149 /oe
150 /breve
151 /dotaccent
152 /perthousand
153 /emdash
154 /ring
155 /Lslash
156 /OE
157 /hungarumlaut
158 /ogonek
159 /caron
160 /lslash
161 /exclamdown
162 /cent
163 /sterling
164 /currency
165 /yen
166 /brokenbar
167 /section
168 /dieresis
169 /copyright
170 /ordfeminine
171 /guillemotleft
172 /logicalnot
173 /hyphen
174 /registered
175 /macron
176 /degree
177 /plusminus
178 /twosuperior
179 /threesuperior
180 /acute
181 /mu
182 /paragraph
183 /periodcentered
184 /cedilla
185 /onesuperior
186 /ordmasculine
187 /guillemotright
188 /onequarter
189 /onehalf
190 /threequarters
191 /questiondown
192 /Agrave
193 /Aacute
194 /Acircumflex
195 /Atilde
196 /Adieresis
197 /Aring
198 /AE
199 /Ccedilla
200 /Egrave
201 /Eacute
202 /Ecircumflex
203 /Edieresis
204 /Igrave
205 /Iacute
206 /Icircumflex
207 /Idieresis
208 /Eth
209 /Ntilde
210 /Ograve
211 /Oacute
212 /Ocircumflex
213 /Otilde
214 /Odieresis
215 /multiply
216 /Oslash
217 /Ugrave
218 /Uacute
219 /Ucircumflex
220 /Udieresis
221 /Yacute
222 /Thorn
223 /germandbls
224 /agrave
225 /aacute
226 /acircumflex
227 /atilde
228 /adieresis
229 /aring
230 /ae
231 /ccedilla
232 /egrave
233 /eacute
234 /ecircumflex
235 /edieresis
236 /igrave
237 /iacute
238 /icircumflex
239 /idieresis
240 /eth
241 /ntilde
242 /ograve
243 /oacute
244 /ocircumflex
245 /otilde
246 /odieresis
247 /divide
248 /oslash
249 /ugrave
250 /uacute
251 /ucircumflex
252 /udieresis
253 /yacute
254 /thorn
255 /ydieresis
] def
/Courier /OurCharSet charvec ReEncodeSmall
/textfont /OurCharSet findfont 11 scalefont def
/fnamefont /Times-Bold findfont 14 scalefont def
/headerfont /Times-Bold findfont 12 scalefont def
textfont setfont
(a) stringwidth pop /mp_a_x exch def
%%EndProlog
%%Page: 1 1
save
0 setlinewidth
18 18 moveto 0 806 rlineto
560 0 rlineto 0 -806 rlineto closepath stroke
18 421 moveto 560 0 rlineto stroke
298 18 moveto 0 806 rlineto stroke
gsave
18 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
0 780 moveto (::::::::::::::) show
0 768 moveto (bdfk2_dae.m) show
0 756 moveto (::::::::::::::) show
0 744 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 732 moveto (% BDFk-Verfahren, variable-step variable-order BDF) show
0 720 moveto (%) show
0 708 moveto (% Loesen der differentiell-algebraischen Gleichung 2. Ordung der Form) show
0 696 moveto (% M y''\(t\)=D y'\(t\) + S y\(t\) + f\(t,y,y'\)) show
0 684 moveto (%) show
0 672 moveto (% mit BDF der Ordnung Ordnung k) show
0 660 moveto (%) show
0 648 moveto (% CALL  : [t,h,y,y_est,y_interpol]=bdfk2dae\(funct,y0,y1,t0,a,N,K,RTOL,ATOL,H0\)) show
0 636 moveto (%) show
0 624 moveto (% INPUT : funct - Name der aufzurufenden Routine, die die Matrizen M, D, S und Vektor f bestimmt) show
0 612 moveto (%                 \(Text-String\)) show
0 600 moveto (%         y0,y1 - initial value) show
0 588 moveto (%         t0    - initial time         t\\in[t0,t0+a]) show
0 576 moveto (%         a     - length of interval   t\\in[t0,t0+a]) show
0 564 moveto (%         N     - number of steps) show
0 552 moveto (%         K     - maximal order) show
0 540 moveto (%) show
0 528 moveto (% OUTPUT: t    - time steps t=[t0,t0+h,...,t0+\(N-1\)*h,t0+N*h=t0+a]) show
0 516 moveto (%         h    - stepsizes) show
0 504 moveto (%         y    - approximation of solution at t\(i\)) show
0 492 moveto (%) show
0 480 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 468 moveto (function [t,h,y]=bdfk2_dae\(funct,funct_d1,funct_d2,funct_d3,nL,y0,y1,t0,a,N,K,RTOL,ATOL,H0,step,exponent\)) show
0 444 moveto (% check input arguments) show
0 432 moveto (maxOrder=2;) show
0 420 moveto (if\(K>maxOrder || K<1\)) show
5 mp_a_x mul 408 moveto (error\('wrong order'\);) show
0 396 moveto (end) show
0 372 moveto (if\(a==0\)) show
4 mp_a_x mul 360 moveto (error\('wrong interval'\);) show
0 348 moveto (end) show
0 324 moveto (TIME=t0:a/N:t0+a;) show
0 312 moveto (t\(1\)=t0;) show
0 288 moveto (TOUT=t0+a;) show
0 264 moveto (% initial stepsize) show
0 252 moveto (if\(H0==0\)) show
4 mp_a_x mul 240 moveto (H0 = sign\(TOUT-t0\)*min\(10^\(-3\)*abs\(TOUT-t0\),0.5*myNorm\(y1,RTOL,ATOL\)^\(-1\)\);) show
0 228 moveto (end) show
0 204 moveto (h\(1\)=H0\(1\);) show
0 180 moveto ([n,m]=size\(y0\);) show
0 168 moveto ([n1,m1]=size\(y1\);) show
0 144 moveto (y\(1:n,1\)=y0;) show
0 132 moveto (y\(n+1:n+n1,1\)=y1;) show
0 120 moveto (y_interpol\(:,1\)=y\(:,1\);) show
0 96 moveto (iNoRej=0;nef=0;ncf=0;nsf=0;iPhase=0;newOrder = 0;) show
0 72 moveto (% integration) show
0 60 moveto (i=1;I=1;) show
0 36 moveto (while\(i<=2000 && t\(i\)<=TOUT\)) show
4 mp_a_x mul 24 moveto (i) show
4 mp_a_x mul 12 moveto (t\(i+1\) = t\(i\)+h\(i\);) show
4 mp_a_x mul 0 moveto (h\(i+1\) = h\(i\);) show
grestore
gsave
18 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
4 mp_a_x mul 768 moveto (%order selection -> k) show
4 mp_a_x mul 756 moveto (if\( i <= 6\)) show
8 mp_a_x mul 744 moveto (if\(K==1\)) show
12 mp_a_x mul 732 moveto (if\(i==1\)) show
16 mp_a_x mul 720 moveto (KK\(1\)=1;) show
16 mp_a_x mul 708 moveto (KK\(2\)=2;) show
16 mp_a_x mul 696 moveto (KK\(3\)=0;) show
12 mp_a_x mul 684 moveto (end) show
12 mp_a_x mul 672 moveto (if\(i>1\)) show
16 mp_a_x mul 660 moveto (KK\(1\)=1;) show
16 mp_a_x mul 648 moveto (KK\(2\)=1;) show
16 mp_a_x mul 636 moveto (KK\(3\)=0;) show
12 mp_a_x mul 624 moveto (end) show
8 mp_a_x mul 612 moveto (end) show
8 mp_a_x mul 600 moveto (if\(K==2\)) show
12 mp_a_x mul 588 moveto (if\(i==1\)) show
16 mp_a_x mul 576 moveto (KK\(1\)=1;) show
16 mp_a_x mul 564 moveto (KK\(2\)=2;) show
16 mp_a_x mul 552 moveto (KK\(3\)=0;) show
12 mp_a_x mul 540 moveto (end) show
12 mp_a_x mul 528 moveto (if\(i==2\)) show
16 mp_a_x mul 516 moveto (KK\(1\)=2;) show
16 mp_a_x mul 504 moveto (KK\(2\)=1;) show
16 mp_a_x mul 492 moveto (KK\(3\)=3;) show
12 mp_a_x mul 480 moveto (end) show
12 mp_a_x mul 468 moveto (if\(i==3\)) show
16 mp_a_x mul 456 moveto (KK\(1\)=2;) show
16 mp_a_x mul 444 moveto (KK\(2\)=2;) show
16 mp_a_x mul 432 moveto (KK\(3\)=1;) show
12 mp_a_x mul 420 moveto (end) show
12 mp_a_x mul 408 moveto (if\(i>3\)) show
16 mp_a_x mul 396 moveto (KK\(1\)=2;) show
16 mp_a_x mul 384 moveto (KK\(2\)=2;) show
16 mp_a_x mul 372 moveto (KK\(3\)=2;) show
12 mp_a_x mul 360 moveto (end) show
8 mp_a_x mul 348 moveto (end) show
4 mp_a_x mul 336 moveto (else %\( i> 4\)) show
0 324 moveto (%         if\(newOrder==1\) % increase order) show
0 312 moveto (%             if\( KK\(1\) == maxOrder\) % k=k+1) show
0 300 moveto (%                 temp = KK\(1\);) show
0 288 moveto (%             else) show
0 276 moveto (%                 temp = KK\(1\)+1;) show
0 264 moveto (%             end) show
0 252 moveto (%             for zz = temp+1:-1:2) show
0 240 moveto (%                 KK\(zz\) = KK\(zz-1\);) show
0 228 moveto (%             end) show
0 216 moveto (%             KK\(1\) = temp;) show
0 204 moveto (% ) show
0 192 moveto (%         elseif\(newOrder==2\) % decrease order) show
0 180 moveto (%             if\( KK\(1\) == 1\)) show
0 168 moveto (%                 KK\(1\) = KK\(1\);) show
0 156 moveto (%             else) show
0 144 moveto (%                 KK\(1\) = KK\(1\)-1;) show
0 132 moveto (%             end) show
0 120 moveto (%             for zz = KK\(1\)+1:-1:2) show
0 108 moveto (%                 KK\(zz\) = KK\(zz-1\) ;) show
0 96 moveto (%             end) show
0 84 moveto (%         elseif\(newOrder==3\) % order constant) show
0 72 moveto (%             KK\(1\) = KK\(1\);) show
0 60 moveto (%             for zz=KK\(1\)+1:-1:2) show
0 48 moveto (%                 KK\(zz\) = KK\(zz-1\);) show
0 36 moveto (%             end) show
0 24 moveto (%         else) show
0 12 moveto (%             error\('order selection'\);) show
0 0 moveto (%         end) show
grestore
gsave
298 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
4 mp_a_x mul 780 moveto (end) show
4 mp_a_x mul 744 moveto (if\( i<4 \)) show
8 mp_a_x mul 732 moveto (if\(i==1\) ) show
12 mp_a_x mul 720 moveto (T=[t\(2\),t\(1\),t\(1\)-h\(1\),t\(1\)-2*h\(1\),t\(1\)-3*h\(1\)];) show
8 mp_a_x mul 708 moveto (end) show
8 mp_a_x mul 696 moveto (if\(i==2\) ) show
12 mp_a_x mul 684 moveto (T=[t\(3\),t\(2\),t\(1\),t\(1\)-h\(1\),t\(1\)-2*h\(1\),t\(1\)-3*h\(1\)];) show
8 mp_a_x mul 672 moveto (end) show
8 mp_a_x mul 660 moveto (if\(i==3\) ) show
12 mp_a_x mul 648 moveto (T=[t\(4\),t\(3\),t\(2\),t\(1\),t\(1\)-h*\(1\)];) show
8 mp_a_x mul 636 moveto (end) show
4 mp_a_x mul 624 moveto (else) show
8 mp_a_x mul 612 moveto (time = KK\(KK\(1\)+1\)+KK\(1\)+1;) show
8 mp_a_x mul 600 moveto (T=t\(i+1:-1:i- time +2\);) show
4 mp_a_x mul 588 moveto (end) show
4 mp_a_x mul 552 moveto ([y\(:,i+1\),converged, IER ] = bdf2_step\(funct,funct_d1,funct_d2,funct_d3,n,nL,KK,T,t,h,i,y,RTOL,ATOL\);) show
4 mp_a_x mul 504 moveto (% Error Estimate - extrapolation) show
4 mp_a_x mul 492 moveto (if\(i<=4\)) show
8 mp_a_x mul 480 moveto (y_est\(:,i+1\)=extrapol\(t,y,i-1\);) show
8 mp_a_x mul 468 moveto (err2\(:,i+1\)=myNorm\(y_est\(:,i+1\)-y\(:,i+1\),RTOL,ATOL\);) show
4 mp_a_x mul 456 moveto (end) show
4 mp_a_x mul 444 moveto (if\(i>4\)) show
8 mp_a_x mul 432 moveto (y_est\(:,i+1\)=extrapol\(t,y,3\);) show
8 mp_a_x mul 420 moveto (err2\(:,i+1\)=myNorm\(y_est\(:,i+1\)-y\(:,i+1\),RTOL,ATOL\);) show
4 mp_a_x mul 408 moveto (end) show
4 mp_a_x mul 372 moveto (hmin = 4*eps*max\(abs\(t\(i+1\)\),abs\(TOUT\)\);) show
4 mp_a_x mul 348 moveto (EST=err2\(:,i+1\);) show
4 mp_a_x mul 312 moveto (if\( step ==1 \)) show
8 mp_a_x mul 288 moveto (if\( i>5\)) show
12 mp_a_x mul 276 moveto (if\( err2\(:,i+1\) <= 1.0\)) show
16 mp_a_x mul 252 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 240 moveto (% step successful) show
16 mp_a_x mul 228 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 216 moveto (if\(iPhase==0\)) show
20 mp_a_x mul 204 moveto (newOrder = 1;) show
20 mp_a_x mul 192 moveto (h\(i+1\)=2*h\(i\);) show
20 mp_a_x mul 180 moveto (iPhase=0;) show
20 mp_a_x mul 168 moveto (iNoRej=0;) show
16 mp_a_x mul 156 moveto (else) show
20 mp_a_x mul 144 moveto (r=\(2*EST+0.0001\)^\(-1/\(KK\(1\)+1\)\);) show
20 mp_a_x mul 132 moveto (if\( r < 2.0\)) show
24 mp_a_x mul 120 moveto (if\( r > 1.0\)) show
28 mp_a_x mul 108 moveto (h\(i+1\)=h\(i\);) show
24 mp_a_x mul 96 moveto (else) show
28 mp_a_x mul 84 moveto (r = max\(0.5,min\(0.9,r\)\);) show
28 mp_a_x mul 72 moveto (h\(i+1\)=r*h\(i\);) show
24 mp_a_x mul 60 moveto (end) show
20 mp_a_x mul 48 moveto (else) show
24 mp_a_x mul 36 moveto (h\(i+1\)=2*h\(i\);) show
20 mp_a_x mul 24 moveto (end) show
20 mp_a_x mul 12 moveto (iPhase=0;) show
20 mp_a_x mul 0 moveto (newOrder = 3;) show
grestore
gsave
298 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
16 mp_a_x mul 780 moveto (end) show
16 mp_a_x mul 756 moveto (nef=0;) show
16 mp_a_x mul 744 moveto (ncf=0;) show
16 mp_a_x mul 732 moveto (nsf=0;) show
16 mp_a_x mul 708 moveto (% interpolation between meshpoints) show
16 mp_a_x mul 696 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
20 mp_a_x mul 684 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
20 mp_a_x mul 672 moveto (I=I+1;) show
16 mp_a_x mul 660 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
20 mp_a_x mul 648 moveto (while\(TIME\(I+1\)<t\(i+1\)\)) show
24 mp_a_x mul 636 moveto (if\(i>5\)) show
28 mp_a_x mul 624 moveto (nn=5;) show
24 mp_a_x mul 612 moveto (else) show
28 mp_a_x mul 600 moveto (nn=i;) show
24 mp_a_x mul 588 moveto (end) show
24 mp_a_x mul 576 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),nn\);) show
24 mp_a_x mul 564 moveto (I=I+1;) show
24 mp_a_x mul 552 moveto (if\(I-1==N\)) show
28 mp_a_x mul 540 moveto (return) show
24 mp_a_x mul 528 moveto (end) show
20 mp_a_x mul 516 moveto (end) show
16 mp_a_x mul 504 moveto (end) show
12 mp_a_x mul 480 moveto (else) show
16 mp_a_x mul 468 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 456 moveto (% reject step, step unsucessful) show
16 mp_a_x mul 444 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 432 moveto (iPhase=1;) show
16 mp_a_x mul 408 moveto (%restore y,t,y_est,err1) show
16 mp_a_x mul 396 moveto (y=y\(:,1:i\);) show
16 mp_a_x mul 384 moveto (t=t\(1:i\);) show
16 mp_a_x mul 372 moveto (y_est=y_est\(:,1:i\);) show
16 mp_a_x mul 360 moveto (err2=err2\(:,1:i\);) show
16 mp_a_x mul 336 moveto (i=i-1;) show
16 mp_a_x mul 324 moveto (iNoRej=iNoRej+1;) show
16 mp_a_x mul 300 moveto (%test whether failure was due to corrector iteration  or error test failure) show
16 mp_a_x mul 288 moveto (if\(converged==0\)   % Newton iteration converged) show
20 mp_a_x mul 276 moveto (nef = nef+1;) show
20 mp_a_x mul 264 moveto (if\(nef > 1\)) show
24 mp_a_x mul 252 moveto (if\( nef > 2\)) show
28 mp_a_x mul 240 moveto (newOrder=2;) show
28 mp_a_x mul 228 moveto (r=0.25;) show
28 mp_a_x mul 216 moveto (h\(i+1\)=r*h\(i+1\);) show
28 mp_a_x mul 204 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
32 mp_a_x mul 192 moveto (error\('minimal stepsize 1'\);) show
28 mp_a_x mul 180 moveto (end) show
24 mp_a_x mul 168 moveto (else % second error test failure) show
28 mp_a_x mul 156 moveto (newOrder=3;) show
28 mp_a_x mul 144 moveto (r=0.25;) show
28 mp_a_x mul 132 moveto (h\(i+1\)=r*h\(i+1\);) show
28 mp_a_x mul 120 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
32 mp_a_x mul 108 moveto (error\('minimal stepsize 2'\);) show
28 mp_a_x mul 96 moveto (end) show
24 mp_a_x mul 84 moveto (end) show
20 mp_a_x mul 72 moveto (else  % first error test failure) show
24 mp_a_x mul 60 moveto (newOrder=3;) show
24 mp_a_x mul 48 moveto (r=0.9*\(2.0*EST+0.0001\)^\(-1/\(KK\(1\)+1\)\);) show
24 mp_a_x mul 36 moveto (r=max\(0.25,min\(0.9,r\)\);) show
24 mp_a_x mul 24 moveto (h\(i+1\)=r*h\(i+1\);) show
24 mp_a_x mul 12 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
28 mp_a_x mul 0 moveto (error\('minimal stepsize 3'\);) show
grestore
restore
showpage
%%Page: 2 2
save
0 setlinewidth
18 18 moveto 0 806 rlineto
560 0 rlineto 0 -806 rlineto closepath stroke
18 421 moveto 560 0 rlineto stroke
298 18 moveto 0 806 rlineto stroke
gsave
18 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
24 mp_a_x mul 780 moveto (end) show
20 mp_a_x mul 768 moveto (end) show
16 mp_a_x mul 744 moveto (else % Newton iteration failed to converge) show
20 mp_a_x mul 732 moveto (if\(IER == 0\)) show
24 mp_a_x mul 720 moveto (ncf=ncf+1;) show
24 mp_a_x mul 708 moveto (r=0.25;) show
24 mp_a_x mul 696 moveto (h\(i+1\)=r*h\(i+1\);) show
24 mp_a_x mul 684 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
28 mp_a_x mul 672 moveto (error\('minimal stepsize 4'\);) show
24 mp_a_x mul 660 moveto (end) show
20 mp_a_x mul 648 moveto (else) show
24 mp_a_x mul 636 moveto (nsf=nsf+1;) show
24 mp_a_x mul 624 moveto (r=0.25;) show
24 mp_a_x mul 612 moveto (h\(i+1\)=r*h\(i+1\);) show
24 mp_a_x mul 600 moveto (if\(abs\(h\(i+1\)\)<hmin || nsf >3 \)) show
28 mp_a_x mul 588 moveto (error\('minimal stepsize or nsf >3'\);) show
24 mp_a_x mul 576 moveto (end) show
20 mp_a_x mul 552 moveto (end) show
20 mp_a_x mul 528 moveto (newOrder=3;) show
16 mp_a_x mul 516 moveto (end) show
12 mp_a_x mul 492 moveto (end) show
8 mp_a_x mul 480 moveto (else) show
12 mp_a_x mul 468 moveto (% interpolation between meshpoints) show
12 mp_a_x mul 456 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
16 mp_a_x mul 444 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
16 mp_a_x mul 432 moveto (I=I+1;) show
12 mp_a_x mul 420 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
16 mp_a_x mul 408 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),i\);) show
16 mp_a_x mul 396 moveto (I=I+1;) show
12 mp_a_x mul 384 moveto (end) show
8 mp_a_x mul 372 moveto (end) show
4 mp_a_x mul 348 moveto (else    % constant stepsize) show
8 mp_a_x mul 336 moveto (h\(i+1\) =h\(i\);) show
8 mp_a_x mul 300 moveto (if\( i>5\)) show
12 mp_a_x mul 288 moveto (%if\( err2\(:,i+1\) <= 1.0\)) show
16 mp_a_x mul 264 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 252 moveto (% step successful) show
16 mp_a_x mul 240 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 228 moveto (if\(iPhase==0\)) show
20 mp_a_x mul 216 moveto (newOrder = 1;) show
20 mp_a_x mul 204 moveto (iPhase=0;) show
20 mp_a_x mul 192 moveto (iNoRej=0;) show
16 mp_a_x mul 180 moveto (else) show
20 mp_a_x mul 168 moveto (iPhase=0;) show
20 mp_a_x mul 156 moveto (newOrder = 3;) show
16 mp_a_x mul 144 moveto (end) show
16 mp_a_x mul 120 moveto (nef=0;) show
16 mp_a_x mul 108 moveto (ncf=0;) show
16 mp_a_x mul 96 moveto (nsf=0;) show
16 mp_a_x mul 72 moveto (% interpolation between meshpoints) show
16 mp_a_x mul 60 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
20 mp_a_x mul 48 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
20 mp_a_x mul 36 moveto (I=I+1;) show
16 mp_a_x mul 24 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
20 mp_a_x mul 12 moveto (while\(TIME\(I+1\)<t\(i+1\)\)) show
24 mp_a_x mul 0 moveto (if\(i>5\)) show
grestore
gsave
18 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
28 mp_a_x mul 780 moveto (nn=5;) show
24 mp_a_x mul 768 moveto (else) show
28 mp_a_x mul 756 moveto (nn=i;) show
24 mp_a_x mul 744 moveto (end) show
24 mp_a_x mul 732 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),nn\);) show
24 mp_a_x mul 720 moveto (I=I+1;) show
24 mp_a_x mul 708 moveto (if\(I-1==N\)) show
28 mp_a_x mul 696 moveto (return) show
24 mp_a_x mul 684 moveto (end) show
20 mp_a_x mul 672 moveto (end) show
16 mp_a_x mul 660 moveto (end) show
12 mp_a_x mul 624 moveto (%else) show
0 612 moveto (%                 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 600 moveto (%                 % reject step, step unsucessful) show
0 588 moveto (%                 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 576 moveto (%                 iPhase=1;) show
0 564 moveto (% ) show
0 552 moveto (%                 %restore y,t,y_est,err1) show
0 540 moveto (%                 y=y\(:,1:i\);) show
0 528 moveto (%                 t=t\(1:i\);) show
0 516 moveto (%                 y_est=y_est\(:,1:i\);) show
0 504 moveto (%                 err2=err2\(:,1:i\);) show
0 492 moveto (% ) show
0 480 moveto (%                 i=i-1;) show
0 468 moveto (%                 iNoRej=iNoRej+1;) show
0 456 moveto (% ) show
0 444 moveto (%                 %test whether failure was due to corrector iteration  or error test failure) show
0 432 moveto (%                 if\(converged==0\)   % Newton iteration converged) show
0 420 moveto (%                     nef = nef+1;) show
0 408 moveto (%                     if\(nef > 1\)) show
0 396 moveto (%                         if\( nef > 2\)) show
0 384 moveto (%                             newOrder=2;) show
0 372 moveto (%                         else % second error test failure) show
0 360 moveto (%                             newOrder=3;) show
0 348 moveto (%                         end) show
0 336 moveto (%                     else  % first error test failure) show
0 324 moveto (%                         newOrder=3;) show
0 312 moveto (%                     end) show
0 300 moveto (% ) show
0 288 moveto (%                 else % Newton iteration failed to converge) show
0 276 moveto (%                     if\(IER == 0\)) show
0 264 moveto (%                         ncf=ncf+1;) show
0 252 moveto (%                     else) show
0 240 moveto (%                         nsf=nsf+1;) show
0 228 moveto (%                     end) show
0 216 moveto (%                     newOrder=3;) show
0 204 moveto (%                 end) show
0 192 moveto (% ) show
0 180 moveto (%             end) show
8 mp_a_x mul 168 moveto (else) show
12 mp_a_x mul 156 moveto (% interpolation between meshpoints) show
12 mp_a_x mul 144 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
16 mp_a_x mul 132 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
16 mp_a_x mul 120 moveto (I=I+1;) show
12 mp_a_x mul 108 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
16 mp_a_x mul 96 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),i\);) show
16 mp_a_x mul 84 moveto (I=I+1;) show
12 mp_a_x mul 72 moveto (end) show
8 mp_a_x mul 60 moveto (end) show
4 mp_a_x mul 48 moveto (end) show
4 mp_a_x mul 24 moveto (i=i+1;) show
0 0 moveto (end) show
grestore
gsave
298 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
0 768 moveto (::::::::::::::) show
0 756 moveto (bdf2_step.m) show
0 744 moveto (::::::::::::::) show
0 732 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 720 moveto (% BDF step) show
0 708 moveto (%) show
0 696 moveto (% solves nonlinear system of equations with Newton's method) show
0 684 moveto (% DF*d=-F) show
0 672 moveto (%) show
0 660 moveto (% Iteration  x\(m+1\)=x\(m\)-c*inv\(J\)* F\(x\(m\)\)) show
0 648 moveto (%) show
0 636 moveto (% CALL  :) show
0 624 moveto (% [y,x,converged,IER]=Newton\(funct,t,h,x0,y,RTOL,ATOL,K,a\)) show
0 612 moveto (%) show
0 600 moveto (% INPUT:    funct   - Name der aufzurufenden Routine, die die Matrizen M, D,) show
0 588 moveto (%                     S und Vektor f bestimmt) show
0 576 moveto (%) show
0 564 moveto (%           x0      - starting value for Newton-iteration) show
0 552 moveto (%           t       - current time) show
0 540 moveto (%           h       - current stepsize) show
0 528 moveto (%           K       - current order) show
0 516 moveto (%           a       - vector of bdf coefficients) show
0 504 moveto (%           RTOL    - relative tolerance) show
0 492 moveto (%           ATOL    - absolute tolerance) show
0 480 moveto (%) show
0 468 moveto (% OUTPUT: y         - approximation of solution at t\(i+1\)) show
0 456 moveto (%         x         - all iterates) show
0 444 moveto (%         coverged  - converged==0->Iteration has converged, converged==1->) show
0 432 moveto (%                     iteratiom fails to converge) show
0 420 moveto (%         IER       - IER=-1 ->DF singular, else regular) show
0 408 moveto (%) show
0 396 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   ) show
0 384 moveto (function [ y,converged, IER ] = bdf2_step\(funct,funct_d1,funct_d2,funct_d3,n,nL,KK,TT,t,h,i,y,RTOL,ATOL,exponent \)) show
4 mp_a_x mul 360 moveto (% BDF coefficients of BDF\(l,j,k\)) show
4 mp_a_x mul 348 moveto (a = bdfk_coef\(KK,TT\);) show
4 mp_a_x mul 324 moveto (nq = n-nL;  % nL=1 !!) show
4 mp_a_x mul 300 moveto (%predictor value) show
4 mp_a_x mul 288 moveto (sum1=0;) show
4 mp_a_x mul 276 moveto (for ii=1:KK\(1\)+1) show
8 mp_a_x mul 264 moveto (sum1=sum1+phi_star\(ii,i,y,t\(1:i\),h\);) show
4 mp_a_x mul 252 moveto (end) show
4 mp_a_x mul 228 moveto (%starting value for Newton-Iteration) show
4 mp_a_x mul 216 moveto (x\(:,1\)=sum1;) show
4 mp_a_x mul 204 moveto (d\(:,1\)=sum1;) show
4 mp_a_x mul 180 moveto (% Newton-Iteration) show
4 mp_a_x mul 168 moveto (m=1;          ) show
4 mp_a_x mul 156 moveto (maxIt = 4; ) show
4 mp_a_x mul 144 moveto (abbruch=1;) show
4 mp_a_x mul 132 moveto (converged = 0;) show
4 mp_a_x mul 108 moveto (while\(abbruch >= 0.33 && m<=maxIt\)) show
8 mp_a_x mul 84 moveto (y_0=y\(1:n,:\);) show
8 mp_a_x mul 72 moveto (y_1=y\(n+1:n+nq,:\);) show
8 mp_a_x mul 48 moveto (% Zusammenbau von F) show
8 mp_a_x mul 36 moveto (sum1 = 0;) show
8 mp_a_x mul 24 moveto (sum2 = 0;) show
8 mp_a_x mul 12 moveto (sum3 = 0;) show
8 mp_a_x mul 0 moveto (term_a = 0;) show
grestore
gsave
298 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
8 mp_a_x mul 768 moveto (for c=1:KK\(1\)) show
12 mp_a_x mul 756 moveto (sum1 = sum1 + a\(c\)*divDiff\( t\(i+1-c:i+1\),[y_1\(:,i+1-c:i\),x\(n+1:n+nq,m\)],c\);) show
12 mp_a_x mul 744 moveto (prod=1;) show
12 mp_a_x mul 732 moveto (for j=1:c-1) show
16 mp_a_x mul 720 moveto (prod = prod*\(t\(i+1\)-t\(i+1-j\)\);) show
12 mp_a_x mul 708 moveto (end) show
12 mp_a_x mul 696 moveto (sum3 = sum3 + prod*divDiff\(t\(i+1-c:i+1\),[y_0\(1:nq,i+1-c:i\),x\(1:nq,m\)],c\);) show
12 mp_a_x mul 684 moveto (sum2 = sum2 + 1/\(t\(i+1\)-t\(i+1-c\)\);) show
12 mp_a_x mul 672 moveto (prod2=1;) show
12 mp_a_x mul 660 moveto (for j=1:c) show
16 mp_a_x mul 648 moveto (prod2=prod2*\(t\(i+1\)-t\(i+1-j\)\);) show
12 mp_a_x mul 636 moveto (end) show
12 mp_a_x mul 624 moveto (term_a=term_a+a\(c\)*1/prod2;) show
8 mp_a_x mul 612 moveto (end) show
8 mp_a_x mul 588 moveto (F =  [feval\(funct,    t\(i+1\),x\(1:n,m\),x\(n+1:n+nq,m\), sum1 \)) show
14 mp_a_x mul 576 moveto (x\(n+1:n+nq,m\)-sum3];) show
8 mp_a_x mul 540 moveto (D1=feval\(funct_d1,t\(i+1\),x\(1:n,m\),x\(n+1:n+nq,m\), sum1\);) show
8 mp_a_x mul 528 moveto (D2=feval\(funct_d3,t\(i+1\),x\(1:n,m\),x\(n+1:n+nq,m\), sum1,'bdf'\)*term_a-feval\(funct_d2,t\(i+1\),x\(1:n,m\),x\(n+1:n+nq,m\), sum1,'bdf'\);) show
8 mp_a_x mul 516 moveto (D3= eye\(nq,nq+nL\).*\(-sum2\);) show
8 mp_a_x mul 504 moveto (D4= eye\(nq,nq\);) show
8 mp_a_x mul 492 moveto (DF= [D1 D2) show
13 mp_a_x mul 480 moveto (D3 D4];) show
8 mp_a_x mul 456 moveto (if\( det\(DF\) == 0\) % J singular) show
12 mp_a_x mul 444 moveto (IER=-1;) show
8 mp_a_x mul 432 moveto (else) show
12 mp_a_x mul 420 moveto (IER=0; % J regular) show
8 mp_a_x mul 408 moveto (end; ) show
8 mp_a_x mul 384 moveto (% Gauss Zerlegung) show
8 mp_a_x mul 372 moveto ([L,U,P]=lu\(DF\);) show
8 mp_a_x mul 360 moveto (bb = P*\(-F\);) show
8 mp_a_x mul 348 moveto (%yy = L\\bb;) show
8 mp_a_x mul 336 moveto (%d\(:,m+1\) = U\\yy;) show
8 mp_a_x mul 324 moveto (yy = forward\(L,bb\);) show
8 mp_a_x mul 312 moveto (d\(:,m+1\) = backward\(U,yy\);) show
8 mp_a_x mul 276 moveto (x\(:,m+1\)=x\(:,m\)+d\(:,m+1\);) show
8 mp_a_x mul 252 moveto (m=m+1;) show
8 mp_a_x mul 240 moveto (if\(m>2\)) show
12 mp_a_x mul 228 moveto (rho = \(myNorm\(x\(:,m\)-x\(:,m-1\),RTOL,ATOL\)/myNorm\(x\(:,2\)-x\(:,1\),RTOL,ATOL\)\)^\(1/\(m-1\)\);) show
12 mp_a_x mul 216 moveto (abbruch = rho/\(1-rho\)*myNorm\(x\(:,m\)-x\(:,m-1\),RTOL,ATOL\);) show
12 mp_a_x mul 204 moveto (if\(rho>0.9\)) show
16 mp_a_x mul 192 moveto (converged = 1;) show
16 mp_a_x mul 180 moveto (y=x\(:,m\);) show
16 mp_a_x mul 168 moveto (return;) show
12 mp_a_x mul 156 moveto (end) show
8 mp_a_x mul 144 moveto (end) show
4 mp_a_x mul 132 moveto (end) show
4 mp_a_x mul 108 moveto (if\(m > maxIt\)) show
8 mp_a_x mul 96 moveto (converged = 1;) show
4 mp_a_x mul 84 moveto (end) show
4 mp_a_x mul 60 moveto (y=x\(:,m\);) show
4 mp_a_x mul 12 moveto (::::::::::::::) show
0 0 moveto (RK2dae.m) show
grestore
restore
showpage
%%Page: 3 3
save
0 setlinewidth
18 18 moveto 0 806 rlineto
560 0 rlineto 0 -806 rlineto closepath stroke
18 421 moveto 560 0 rlineto stroke
298 18 moveto 0 806 rlineto stroke
gsave
18 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
0 780 moveto (::::::::::::::) show
0 768 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 756 moveto (% Runge-Kutta method) show
0 744 moveto (%) show
0 732 moveto (% Solution of second order differential-algebraic equations \( equations of motion\)) show
0 720 moveto (% of the form) show
0 708 moveto (% M q''\(t\)= f\(t,q,q'\)-G^T\(q,t\)lambda) show
0 696 moveto (%       0 = g\(q,t\)) show
0 684 moveto (%) show
0 672 moveto (% with 2-stage Runge-Kutta method.) show
0 660 moveto (%) show
0 648 moveto (% CALL  :) show
0 636 moveto (% [t,h,y,y_2]=RK2dae\(funct,y0,y1,t0,a,N,s,RTOL,ATOL,H0,type\)) show
0 624 moveto (%) show
0 612 moveto (% INPUT : funct - name of routine to determin) show
0 600 moveto (%                 \(Text-String\)) show
0 588 moveto (%         y0,y1 - initial values) show
0 576 moveto (%         t0    - initial time     t\\in[t0,t0+a]) show
0 564 moveto (%         a     - Intervallaenge   t\\in[t0,t0+a]) show
0 552 moveto (%         N     - number of steps) show
0 540 moveto (%         s     - number of stages, s=2 !) show
0 528 moveto (%         RTOL  - relative error tolerance) show
0 516 moveto (%         ATOL  - absolute error tolerance) show
0 504 moveto (%         H0    - initial stepsize, if H0=0 then the code determines the) show
0 492 moveto (%                 initial stepsize) show
0 480 moveto (%         type  - type of Runge-Kutta method) show
0 468 moveto (%                 type = 'Gauss') show
0 456 moveto (%                        'Radau') show
0 444 moveto (%                        'Lobatto') show
0 432 moveto (%) show
0 420 moveto (% OUTPUT: t    - time steps) show
0 408 moveto (%         h    - vector of stepsizes) show
0 396 moveto (%         y    - approximate solution at times t\(i\)) show
0 384 moveto (%) show
0 372 moveto (%) show
0 360 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 348 moveto (function [t,h,y,y_interpol,TIME]=RK2dae\(funct,funct_d1,funct_d2,funct_d3,y0,y1,t0,a,N,s,RTOL,ATOL,H0,type,step\)) show
0 324 moveto (t\(1\)=t0;) show
0 300 moveto (TIME=t0:a/N:t0+a;) show
0 288 moveto (TOUT = t0+a;) show
0 264 moveto (% initial stepsize) show
0 252 moveto (if\(H0==0\)) show
4 mp_a_x mul 240 moveto (H0 = sign\(TOUT-t0\)*min\(10^\(-3\)*abs\(TOUT-t0\),0.5*myNorm\(y1,RTOL,ATOL\)^\(-1\)\);) show
0 228 moveto (end) show
0 204 moveto (TOUT=t0+a;) show
0 180 moveto (h\(1\)=H0;) show
0 156 moveto ([n,m]=size\(y0\);) show
0 144 moveto ([n1,m1]=size\(y1\);) show
0 120 moveto (y\(1:n,1\)=y0;) show
0 108 moveto (y\(n+1:n+n1,1\)=y1;) show
0 96 moveto (y_2\(:,1\)=y\(:,1\);) show
0 84 moveto (y_1\(:,1\)=y\(:,1\);) show
0 72 moveto (y_interpol\(:,1\)=y\(:,1\);) show
0 36 moveto (iNoRej = 0;nef=0;nsf=0;iPhase=0;%newOrder = 0;) show
0 12 moveto (i=1;I=1;) show
grestore
gsave
18 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
0 780 moveto (%facmax = 1.5;facmin = 0.2;fac = 0.8;) show
0 768 moveto (%p=2;) show
0 744 moveto (% Integration) show
0 732 moveto (while\(i<=700&& t\(i\)<=TOUT \)) show
4 mp_a_x mul 720 moveto (i) show
4 mp_a_x mul 708 moveto (t\(i+1\) = t\(i\)+h\(i\);) show
4 mp_a_x mul 696 moveto (h\(i+1\) = h\(i\);) show
4 mp_a_x mul 672 moveto ([y\(:,i+1\),converged] = RK_step\(funct,funct_d1,funct_d2,funct_d3,n,y\(:,1:i\),i,h\(i\),t\(1:i\),s,type,RTOL,ATOL\);) show
4 mp_a_x mul 648 moveto (% Error Estimate - Extrapolationsmethode) show
4 mp_a_x mul 636 moveto (if\(i<=4\)) show
8 mp_a_x mul 624 moveto (y_est\(:,i+1\)=extrapol\(t,y,i-1\);) show
8 mp_a_x mul 612 moveto (err2\(:,i+1\)=myNorm\(y_est\(:,i+1\)-y\(:,i+1\),RTOL,ATOL\);) show
4 mp_a_x mul 600 moveto (end) show
4 mp_a_x mul 588 moveto (if\(i>4\)) show
8 mp_a_x mul 576 moveto (y_est\(:,i+1\)=extrapol\(t,y,3\);) show
8 mp_a_x mul 564 moveto (err2\(:,i+1\)=myNorm\(y_est\(:,i+1\)-y\(:,i+1\),RTOL,ATOL\);) show
4 mp_a_x mul 552 moveto (end) show
4 mp_a_x mul 528 moveto (hmin = 4*eps*max\(abs\(t\(i+1\)\),abs\(TOUT\)\);) show
4 mp_a_x mul 504 moveto (EST=err2\(:,i+1\);) show
4 mp_a_x mul 480 moveto (if\( step ==1\)) show
8 mp_a_x mul 456 moveto (if\( i>5\)) show
12 mp_a_x mul 444 moveto (if\( err2\(:,i+1\) <= 1.0\)) show
16 mp_a_x mul 420 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 408 moveto (% step successful) show
16 mp_a_x mul 396 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 384 moveto (if\(iPhase==0\)) show
20 mp_a_x mul 372 moveto (h\(i+1\)=2*h\(i\);) show
20 mp_a_x mul 360 moveto (iPhase=0;) show
20 mp_a_x mul 348 moveto (iNoRej=0;) show
16 mp_a_x mul 336 moveto (else) show
20 mp_a_x mul 324 moveto (r=\(2*EST+0.0001\)^\(-1/\(1+1\)\);) show
20 mp_a_x mul 312 moveto (if\( r < 2.0\)) show
24 mp_a_x mul 300 moveto (if\( r > 1.0\)) show
28 mp_a_x mul 288 moveto (h\(i+1\)=h\(i\);) show
24 mp_a_x mul 276 moveto (else) show
28 mp_a_x mul 264 moveto (r = max\(0.5,min\(0.9,r\)\);) show
28 mp_a_x mul 252 moveto (h\(i+1\)=r*h\(i\);) show
24 mp_a_x mul 240 moveto (end) show
20 mp_a_x mul 228 moveto (else) show
24 mp_a_x mul 216 moveto (h\(i+1\)=2*h\(i\);) show
20 mp_a_x mul 204 moveto (end) show
20 mp_a_x mul 192 moveto (iPhase=0;) show
16 mp_a_x mul 180 moveto (end) show
16 mp_a_x mul 156 moveto (nef=0;) show
16 mp_a_x mul 144 moveto (%ncf=0;) show
16 mp_a_x mul 132 moveto (nsf=0;) show
16 mp_a_x mul 108 moveto (% interpolation between meshpoints) show
16 mp_a_x mul 96 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
20 mp_a_x mul 84 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
20 mp_a_x mul 72 moveto (I=I+1;) show
16 mp_a_x mul 60 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
20 mp_a_x mul 48 moveto (while\(TIME\(I+1\)<t\(i+1\)\)) show
24 mp_a_x mul 36 moveto (if\(i>5\)) show
28 mp_a_x mul 24 moveto (nn=5;) show
24 mp_a_x mul 12 moveto (else) show
28 mp_a_x mul 0 moveto (nn=i;) show
grestore
gsave
298 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
24 mp_a_x mul 780 moveto (end) show
24 mp_a_x mul 768 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),nn\);) show
24 mp_a_x mul 756 moveto (I=I+1;) show
24 mp_a_x mul 744 moveto (if\(I-1==N\)) show
28 mp_a_x mul 732 moveto (return) show
24 mp_a_x mul 720 moveto (end) show
20 mp_a_x mul 708 moveto (end) show
16 mp_a_x mul 696 moveto (end) show
12 mp_a_x mul 672 moveto (else) show
16 mp_a_x mul 660 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 648 moveto (% reject step, step unsucessful) show
16 mp_a_x mul 636 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 624 moveto (iPhase=1;) show
16 mp_a_x mul 600 moveto (%restore y,t,y_est,err1) show
16 mp_a_x mul 588 moveto (y=y\(:,1:i\);) show
16 mp_a_x mul 576 moveto (t=t\(1:i\);) show
16 mp_a_x mul 564 moveto (y_est=y_est\(:,1:i\);) show
16 mp_a_x mul 552 moveto (err2=err2\(:,1:i\);) show
16 mp_a_x mul 528 moveto (i=i-1;) show
16 mp_a_x mul 516 moveto (iNoRej=iNoRej+1;) show
16 mp_a_x mul 492 moveto (%test whether failure was due to corrector iteration  or error test failure) show
16 mp_a_x mul 480 moveto (if\(converged==0\)   % Newton iteration converged) show
20 mp_a_x mul 468 moveto (nef = nef+1;) show
20 mp_a_x mul 456 moveto (if\(nef > 1\)) show
24 mp_a_x mul 444 moveto (if\( nef > 2\)) show
28 mp_a_x mul 432 moveto (r=0.25;) show
28 mp_a_x mul 420 moveto (h\(i+1\)=r*h\(i+1\);) show
28 mp_a_x mul 408 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
32 mp_a_x mul 396 moveto (error\('minimal stepsize'\);) show
28 mp_a_x mul 384 moveto (end) show
24 mp_a_x mul 372 moveto (else % second error test failure) show
28 mp_a_x mul 360 moveto (r=0.25;) show
28 mp_a_x mul 348 moveto (h\(i+1\)=r*h\(i+1\);) show
28 mp_a_x mul 336 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
32 mp_a_x mul 324 moveto (error\('minimal stepsize'\);) show
28 mp_a_x mul 312 moveto (end) show
24 mp_a_x mul 300 moveto (end) show
20 mp_a_x mul 288 moveto (else  % first error test failure) show
24 mp_a_x mul 276 moveto (r=0.9*\(2.0*EST+0.0001\)^\(-1/\(1+1\)\);) show
24 mp_a_x mul 264 moveto (r=max\(0.25,min\(0.9,r\)\);) show
24 mp_a_x mul 252 moveto (h\(i+1\)=r*h\(i+1\);) show
24 mp_a_x mul 240 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
28 mp_a_x mul 228 moveto (error\('minimal stepsize'\);) show
24 mp_a_x mul 216 moveto (end) show
20 mp_a_x mul 204 moveto (end) show
16 mp_a_x mul 180 moveto (else % Newton iteration failed to converge) show
20 mp_a_x mul 168 moveto (nsf=nsf+1;) show
20 mp_a_x mul 156 moveto (r=0.25;) show
20 mp_a_x mul 144 moveto (h\(i+1\)=r*h\(i+1\);) show
20 mp_a_x mul 132 moveto (if\(abs\(h\(i+1\)\)<hmin || nsf >3 \)) show
24 mp_a_x mul 120 moveto (error\('minimal stepsize'\);) show
20 mp_a_x mul 108 moveto (end) show
16 mp_a_x mul 84 moveto (end) show
12 mp_a_x mul 60 moveto (end) show
8 mp_a_x mul 48 moveto (else) show
12 mp_a_x mul 36 moveto (% interpolation between meshpoints) show
12 mp_a_x mul 24 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
16 mp_a_x mul 12 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
16 mp_a_x mul 0 moveto (I=I+1;) show
grestore
gsave
298 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
12 mp_a_x mul 780 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
16 mp_a_x mul 768 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),i\);) show
16 mp_a_x mul 756 moveto (I=I+1;) show
12 mp_a_x mul 744 moveto (end) show
8 mp_a_x mul 720 moveto (end) show
4 mp_a_x mul 696 moveto (else    % constant stepsize) show
8 mp_a_x mul 684 moveto (h\(i+1\)=h\(i\);) show
8 mp_a_x mul 672 moveto (if\( i>5\)) show
12 mp_a_x mul 660 moveto (if\( err2\(:,i+1\) <= 1.0\)) show
16 mp_a_x mul 636 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 624 moveto (% step successful) show
16 mp_a_x mul 612 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 600 moveto (if\(iPhase==0\)) show
20 mp_a_x mul 588 moveto (iPhase=0;) show
20 mp_a_x mul 576 moveto (iNoRej=0;) show
16 mp_a_x mul 564 moveto (else) show
20 mp_a_x mul 552 moveto (iPhase=0;) show
16 mp_a_x mul 540 moveto (end) show
16 mp_a_x mul 516 moveto (nef=0;) show
16 mp_a_x mul 504 moveto (%ncf=0;) show
16 mp_a_x mul 492 moveto (nsf=0;) show
16 mp_a_x mul 468 moveto (% interpolation between meshpoints) show
16 mp_a_x mul 456 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
20 mp_a_x mul 444 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
20 mp_a_x mul 432 moveto (I=I+1;) show
16 mp_a_x mul 420 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
20 mp_a_x mul 408 moveto (while\(TIME\(I+1\)<t\(i+1\)\)) show
24 mp_a_x mul 396 moveto (if\(i>5\)) show
28 mp_a_x mul 384 moveto (nn=5;) show
24 mp_a_x mul 372 moveto (else) show
28 mp_a_x mul 360 moveto (nn=i;) show
24 mp_a_x mul 348 moveto (end) show
24 mp_a_x mul 336 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),nn\);) show
24 mp_a_x mul 324 moveto (I=I+1;) show
24 mp_a_x mul 312 moveto (if\(I-1==N\)) show
28 mp_a_x mul 300 moveto (return) show
24 mp_a_x mul 288 moveto (end) show
20 mp_a_x mul 276 moveto (end) show
16 mp_a_x mul 264 moveto (end) show
12 mp_a_x mul 240 moveto (else) show
16 mp_a_x mul 228 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 216 moveto (% reject step, step unsucessful) show
16 mp_a_x mul 204 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 192 moveto (iPhase=1;) show
16 mp_a_x mul 168 moveto (%restore y,t,y_est,err1) show
16 mp_a_x mul 156 moveto (y=y\(:,1:i\);) show
16 mp_a_x mul 144 moveto (t=t\(1:i\);) show
16 mp_a_x mul 132 moveto (y_est=y_est\(:,1:i\);) show
16 mp_a_x mul 120 moveto (err2=err2\(:,1:i\);) show
16 mp_a_x mul 96 moveto (i=i-1;) show
16 mp_a_x mul 84 moveto (iNoRej=iNoRej+1;) show
16 mp_a_x mul 60 moveto (%test whether failure was due to corrector iteration  or error test failure) show
16 mp_a_x mul 48 moveto (if\(converged==0\)   % Newton iteration converged) show
20 mp_a_x mul 36 moveto (nef = nef+1;) show
16 mp_a_x mul 24 moveto (else % Newton iteration failed to converge) show
20 mp_a_x mul 12 moveto (nsf=nsf+1;) show
16 mp_a_x mul 0 moveto (end) show
grestore
restore
showpage
%%Page: 4 4
save
0 setlinewidth
18 18 moveto 0 806 rlineto
560 0 rlineto 0 -806 rlineto closepath stroke
18 421 moveto 560 0 rlineto stroke
298 18 moveto 0 806 rlineto stroke
gsave
18 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
12 mp_a_x mul 780 moveto (end) show
8 mp_a_x mul 768 moveto (else) show
12 mp_a_x mul 756 moveto (% interpolation between meshpoints) show
12 mp_a_x mul 744 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
16 mp_a_x mul 732 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
16 mp_a_x mul 720 moveto (I=I+1;) show
12 mp_a_x mul 708 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
16 mp_a_x mul 696 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),i\);) show
16 mp_a_x mul 684 moveto (I=I+1;) show
12 mp_a_x mul 672 moveto (end) show
8 mp_a_x mul 648 moveto (end) show
4 mp_a_x mul 636 moveto (end) show
4 mp_a_x mul 612 moveto (i=i+1;) show
0 588 moveto (end) show
0 564 moveto (::::::::::::::) show
0 552 moveto (RK_step.m) show
0 540 moveto (::::::::::::::) show
0 528 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 516 moveto (% Runge-Kutta step) show
0 504 moveto (%) show
0 492 moveto (% Performs one Runge-Kutta step) show
0 480 moveto (%) show
0 468 moveto (% CALL  :) show
0 456 moveto (% [t,h,y,y_2]=RK_step\(funct,y,i,h,t,s,type,RTOL,ATOL\)) show
0 444 moveto (%) show
0 432 moveto (% INPUT : funct - name of routine to determin F) show
0 420 moveto (%                 \(Text-String\)) show
0 408 moveto (%         y     - ) show
0 396 moveto (%         i     - number of current step) show
0 384 moveto (%         h     - current stepsize) show
0 372 moveto (%         t     - current time) show
0 360 moveto (%         s     - number of stages, s=2 !) show
0 348 moveto (%         RTOL  - relative error tolerance) show
0 336 moveto (%         ATOL  - absolute error tolerance) show
0 324 moveto (%         type  - type of Runge-Kutta method) show
0 312 moveto (%                 type = 'Gauss') show
0 300 moveto (%                        'Radau') show
0 288 moveto (%                        'Lobatto') show
0 276 moveto (%) show
0 264 moveto (% OUTPUT: t    - time steps) show
0 252 moveto (%         h    - vector of stepsizes) show
0 240 moveto (%         y    - approximate solution at times t\(i\)) show
0 228 moveto (%         ) show
0 216 moveto (%) show
0 204 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 192 moveto (function [y_new,converged]=RK_step\(funct,funct_d1,funct_d2,funct_d3,n,y,i,h,t,s,type,RTOL,ATOL\)   ) show
0 168 moveto (% starting value for Newton iteration) show
0 156 moveto (x0=zeros\(s*n,1\);) show
0 132 moveto (% maximal number of iterations) show
0 120 moveto (MAXIT = 20;) show
0 96 moveto (x\(:,1\)=x0;   ) show
0 84 moveto (d\(:,1\)=x0;) show
0 72 moveto (abbruch=1;) show
0 48 moveto (% RK-coefficients) show
0 36 moveto ([A,At,b,bt,c] = RK_coef\(s,type\);) show
0 12 moveto (% Iteration counter) show
0 0 moveto (m=1;  ) show
grestore
gsave
18 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
0 780 moveto (while\(abbruch >= 0.33 && m<=MAXIT\)) show
4 mp_a_x mul 756 moveto (ddY = x\(:,m\);) show
4 mp_a_x mul 732 moveto (Y  = kron\(ones\(s,1\),eye\(n,n\)\)*y\(1:n,i\) + h*kron\(c',eye\(n,n\)\)*y\(n+1:2*n,i\) + h^2*kron\(At,eye\(n,n\)\)*ddY;) show
4 mp_a_x mul 720 moveto (dY = kron\(ones\(s,1\),eye\(n,n\)\)*y\(n+1:2*n,i\) + h*kron\(A,eye\(n,n\)\)*ddY;   ) show
4 mp_a_x mul 696 moveto (for j=1:s) show
8 mp_a_x mul 684 moveto (F\(n*\(j-1\)+1:n*j,1\)  = feval\( funct,t\(i\)+c\(j\)*h,Y\(n*\(j-1\)+1:n*j\),dY\(n*\(j-1\)+1:n*j\),ddY\(n*\(j-1\)+1:n*j\)\);) show
7 mp_a_x mul 660 moveto (J\(n*\(j-1\)+1:n*j,n*\(j-1\)+1:n*j\) = feval\(funct_d1,t\(i\)+c\(j\)*h,Y\(n*\(j-1\)+1:n*j\),dY\(n*\(j-1\)+1:n*j\),ddY\(n*\(j-1\)+1:n*j\)\);) show
7 mp_a_x mul 648 moveto (K\(n*\(j-1\)+1:n*j,n*\(j-1\)+1:n*j\) = feval\(funct_d2,t\(i\)+c\(j\)*h,Y\(n*\(j-1\)+1:n*j\),dY\(n*\(j-1\)+1:n*j\),ddY\(n*\(j-1\)+1:n*j\),'rk'\);) show
7 mp_a_x mul 636 moveto (M\(n*\(j-1\)+1:n*j,n*\(j-1\)+1:n*j\) = feval\(funct_d3,t\(i\)+c\(j\)*h,Y\(n*\(j-1\)+1:n*j\),dY\(n*\(j-1\)+1:n*j\),ddY\(n*\(j-1\)+1:n*j\),'rk'\);) show
4 mp_a_x mul 624 moveto (end) show
4 mp_a_x mul 600 moveto (%DF = eye\(s*n,s*n\) - h^2*kron\(At,eye\(n,n\)\)*J - h*kron\(A,eye\(n,n\)\)*K; ) show
4 mp_a_x mul 588 moveto (DF = M + h^2*kron\(At,eye\(n,n\)\)*J + h*kron\(A,eye\(n,n\)\)*K; ) show
4 mp_a_x mul 564 moveto (DF2=1/\(h^2\)*DF;) show
4 mp_a_x mul 552 moveto (F2=1/\(h^2\)*F;) show
4 mp_a_x mul 528 moveto ([LL,UU,PP]=lu\(DF2\);) show
4 mp_a_x mul 516 moveto (f_neu=-PP*F2;) show
4 mp_a_x mul 504 moveto (yy = forward\(LL,f_neu\);) show
4 mp_a_x mul 492 moveto (z1 = backward\(UU,yy\);) show
4 mp_a_x mul 468 moveto (d\(:,m+1\)=z1;) show
4 mp_a_x mul 456 moveto (x\(:,m+1\)=x\(:,m\)+d\(:,m+1\);) show
4 mp_a_x mul 432 moveto (m=m+1;) show
4 mp_a_x mul 420 moveto (if\(m>2\)) show
8 mp_a_x mul 408 moveto (rho = \(myNorm\(x\(:,m\)-x\(:,m-1\),RTOL,ATOL\)/myNorm\(x\(:,2\)-x\(:,1\),RTOL,ATOL\)\)^\(1/\(m-1\)\);) show
8 mp_a_x mul 396 moveto (abbruch = rho/\(1-rho\)*myNorm\(x\(:,m\)-x\(:,m-1\),RTOL,ATOL\);) show
4 mp_a_x mul 384 moveto (end) show
0 372 moveto (end % end while) show
0 348 moveto (if\(m<MAXIT\)) show
4 mp_a_x mul 336 moveto (converged = 0;) show
0 324 moveto (else) show
4 mp_a_x mul 312 moveto (converged = 1;) show
0 300 moveto (end) show
0 264 moveto (y_i = y\(1:n,i\);) show
0 252 moveto (yp_i= y\(n+1:2*n,i\);) show
0 228 moveto (y_ip1  = y_i + h*yp_i + h^2*kron\(bt,eye\(n,n\)\)*x\(:,m\);) show
0 216 moveto (yp_ip1 = yp_i+ h*kron\(b,eye\(n,n\)\)*x\(:,m\);) show
0 180 moveto (% the new approximation at t\(i\)+h) show
0 168 moveto (y_new\(:,1\)=[y_ip1;yp_ip1];) show
0 96 moveto (::::::::::::::) show
0 84 moveto (glm2_dae.m) show
0 72 moveto (::::::::::::::) show
0 60 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 48 moveto (% GLM-Verfahren, variable-step variable-order GLM) show
0 36 moveto (%) show
0 24 moveto (% Loesen der differentiell-algebraischen Gleichung 2. Ordung der Form) show
0 12 moveto (% M y''\(t\)=D y'\(t\) + S y\(t\) + f\(t,y,y'\)) show
0 0 moveto (%) show
grestore
gsave
298 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
0 780 moveto (% mit GLM der Ordnung Ordnung k) show
0 768 moveto (%) show
0 756 moveto (% CALL  : [t,h,y,y_est,y_interpol]=bdfk2dae\(funct,y0,y1,t0,a,N,K,RTOL,ATOL,H0\)) show
0 744 moveto (%) show
0 732 moveto (% INPUT : funct - Name der aufzurufenden Routine, die die Matrizen M, D, S und Vektor f bestimmt) show
0 720 moveto (%                 \(Text-String\)) show
0 708 moveto (%         y0,y1 - initial value) show
0 696 moveto (%         t0    - initial time         t\\in[t0,t0+a]) show
0 684 moveto (%         a     - length of interval   t\\in[t0,t0+a]) show
0 672 moveto (%         N     - number of steps) show
0 660 moveto (%         K     - maximal order) show
0 648 moveto (%) show
0 636 moveto (% OUTPUT: t    - time steps t=[t0,t0+h,...,t0+\(N-1\)*h,t0+N*h=t0+a]) show
0 624 moveto (%         h    - stepsizes) show
0 612 moveto (%         y    - approximation of solution at t\(i\)) show
0 600 moveto (%) show
0 588 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 576 moveto (function [t,h,y,yp,y_est]=glm2_dae\(funct,funct_start,funct_d1,funct_d2,funct_d3,y0,y1,t0,a,N,p,q,k,s,RTOL,ATOL,H0,step\)) show
0 552 moveto (if\(a==0\)) show
4 mp_a_x mul 540 moveto (error\('wrong interval'\);) show
0 528 moveto (end) show
0 504 moveto (TIME=t0:a/N:t0+a;) show
0 492 moveto (t\(1\)=t0;) show
0 468 moveto (TOUT=t0+a;) show
0 444 moveto (% initial stepsize) show
0 432 moveto (if\(H0==0\)) show
4 mp_a_x mul 420 moveto (H0 = sign\(TOUT-t0\)*min\(10^\(-3\)*abs\(TOUT-t0\),0.5*myNorm\(y1,RTOL,ATOL\)^\(-1\)\);) show
0 408 moveto (end) show
0 384 moveto (h\(1\)=H0\(1\);) show
0 360 moveto ([n,m]=size\(y0\);) show
0 336 moveto (iNoRej = 0;nef=0;nsf=0;iPhase=0;) show
0 324 moveto (%newOrder = 0;) show
0 300 moveto (%facmax = 1.5;) show
0 288 moveto (%facmin = 0.2;) show
0 276 moveto (%fac = 0.8;) show
0 240 moveto (% integration) show
0 228 moveto (i=1;) show
0 216 moveto (I=1;) show
0 192 moveto (%[y\(:,1\)] = starting\(funct,funct_d1,funct_d2,funct_d3,n,p,q,k,s,h,t0,y0,y1,RTOL,ATOL\);) show
0 180 moveto (y\(:,1\) = feval\(funct_start,t0,h\(1\),s\);) show
0 168 moveto (yp\(:,1\)  = y\(n+1:2*n,1\)/h\(1\);) show
0 144 moveto (Y\(:,1\)   = kron\(ones\(s,1\),eye\(n,n\)\)*y0;) show
0 132 moveto (dY\(:,1\)   = kron\(ones\(s,1\),eye\(n,n\)\)*y1;) show
0 120 moveto (ddY\(:,1\)  = kron\(ones\(s,1\),eye\(n,n\)\)*y1;) show
0 96 moveto (y_interpol\(:,1\)=y\(:,1\);) show
0 84 moveto (y2\(1:n,1\) = y\(1:n,1\);) show
0 72 moveto (y2\(n+1:2*n,1\) = yp\(:,1\);) show
0 48 moveto (while\(i<700 && t\(i\)<=TOUT\)) show
4 mp_a_x mul 36 moveto (i;) show
4 mp_a_x mul 24 moveto (t\(i+1\) = t\(i\)+h\(i\);) show
4 mp_a_x mul 12 moveto (h\(i+1\) = h\(i\);) show
grestore
gsave
298 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
4 mp_a_x mul 780 moveto (% GLM coefficients) show
4 mp_a_x mul 768 moveto ([M,c] = glm_coef\(p,s,h\(i\)\);) show
0 744 moveto (%     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
0 732 moveto (%     At = M\(1:s,1:s\)) show
0 720 moveto (%     Ut = M\(1:s,s+1:s+k\)) show
0 708 moveto (%     A  = M\(s+1:s+s,1:s\)) show
0 696 moveto (%     U  = M\(s+1:s+s,s+1:s+k\)) show
0 684 moveto (%     Bt = M\(2*s+1:2*s+s,1:s \)) show
0 672 moveto (%     Vt = M\(2*s+1:2*s+s,s+1:s+k \)) show
0 660 moveto (% %     [V,E]=eig\(Vt\);) show
0 648 moveto (%      stabilityRegion\(A,At,U,Ut,Vt,Bt,s\);) show
0 636 moveto (%     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
4 mp_a_x mul 600 moveto (%internal stages -> Newton) show
4 mp_a_x mul 588 moveto ([Y\(:,i+1\),dY\(:,i+1\),ddY\(:,i+1\),converged]= glm_internal\(funct,funct_d1,funct_d2,funct_d3,ddY\(:,i\),y\(:,i\),n,M,c,h,i,t\(i\),s,k,RTOL,ATOL,0 \);) show
4 mp_a_x mul 564 moveto (% output quantities) show
4 mp_a_x mul 552 moveto ([y\(:,i+1\)] =  glm_external\(y\(:,i\), ddY\(:,i+1\),n,M,h,i,s,k \);) show
4 mp_a_x mul 540 moveto (yp\(:,i+1\)  =  y\(n+1:2*n,i+1\)/h\(i\);) show
4 mp_a_x mul 516 moveto (y2\(1:n,i+1\) = y\(1:n,i+1\);) show
4 mp_a_x mul 504 moveto (y2\(n+1:2*n,i+1\) = yp\(:,i+1\);) show
4 mp_a_x mul 480 moveto (% Error Estimate - Extrapolationsmethode) show
4 mp_a_x mul 468 moveto (if\(i<=4\)) show
8 mp_a_x mul 456 moveto (y_est\(:,i+1\)=extrapol\(t,y2,i-1\);) show
8 mp_a_x mul 444 moveto (err2\(:,i+1\)=myNorm\(y_est\(:,i+1\)-y2\(:,i+1\),RTOL,ATOL\);) show
4 mp_a_x mul 432 moveto (end) show
4 mp_a_x mul 420 moveto (if\(i>4\)) show
8 mp_a_x mul 408 moveto (y_est\(:,i+1\)=extrapol\(t,y2,3\);) show
8 mp_a_x mul 396 moveto (err2\(:,i+1\)=myNorm\(y_est\(:,i+1\)-y2\(:,i+1\),RTOL,ATOL\);) show
4 mp_a_x mul 384 moveto (end) show
4 mp_a_x mul 348 moveto (hmin = 4*eps*max\(abs\(t\(i+1\)\),abs\(TOUT\)\);) show
4 mp_a_x mul 324 moveto (EST=err2\(:,i+1\);) show
4 mp_a_x mul 300 moveto (if\( step ==1\)) show
8 mp_a_x mul 276 moveto (if\( i>5\)) show
12 mp_a_x mul 264 moveto (if\( err2\(:,i+1\) <= 1.0\)) show
16 mp_a_x mul 240 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 228 moveto (% step successful) show
16 mp_a_x mul 216 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 204 moveto (if\(iPhase==0\)) show
20 mp_a_x mul 192 moveto (h\(i+1\)=2*h\(i\);) show
20 mp_a_x mul 180 moveto (iPhase=0;) show
20 mp_a_x mul 168 moveto (iNoRej=0;) show
16 mp_a_x mul 156 moveto (else) show
20 mp_a_x mul 144 moveto (r=\(2*EST+0.0001\)^\(-1/\(1+1\)\);) show
20 mp_a_x mul 132 moveto (if\( r < 2.0\)) show
24 mp_a_x mul 120 moveto (if\( r > 1.0\)) show
28 mp_a_x mul 108 moveto (h\(i+1\)=h\(i\);) show
24 mp_a_x mul 96 moveto (else) show
28 mp_a_x mul 84 moveto (r = max\(0.5,min\(0.9,r\)\);) show
28 mp_a_x mul 72 moveto (h\(i+1\)=r*h\(i\);) show
24 mp_a_x mul 60 moveto (end) show
20 mp_a_x mul 48 moveto (else) show
24 mp_a_x mul 36 moveto (h\(i+1\)=2*h\(i\);) show
20 mp_a_x mul 24 moveto (end) show
20 mp_a_x mul 12 moveto (iPhase=0;) show
16 mp_a_x mul 0 moveto (end) show
grestore
restore
showpage
%%Page: 5 5
save
0 setlinewidth
18 18 moveto 0 806 rlineto
560 0 rlineto 0 -806 rlineto closepath stroke
18 421 moveto 560 0 rlineto stroke
298 18 moveto 0 806 rlineto stroke
gsave
18 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
16 mp_a_x mul 768 moveto (nef=0;) show
16 mp_a_x mul 756 moveto (%ncf=0;) show
16 mp_a_x mul 744 moveto (nsf=0;) show
16 mp_a_x mul 720 moveto (% interpolation between meshpoints) show
16 mp_a_x mul 708 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
20 mp_a_x mul 696 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
20 mp_a_x mul 684 moveto (I=I+1;) show
16 mp_a_x mul 672 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
20 mp_a_x mul 660 moveto (while\(TIME\(I+1\)<t\(i+1\)\)) show
24 mp_a_x mul 648 moveto (if\(i>5\)) show
28 mp_a_x mul 636 moveto (nn=5;) show
24 mp_a_x mul 624 moveto (else) show
28 mp_a_x mul 612 moveto (nn=i;) show
24 mp_a_x mul 600 moveto (end) show
24 mp_a_x mul 588 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),nn\);) show
24 mp_a_x mul 576 moveto (I=I+1;) show
24 mp_a_x mul 564 moveto (if\(I-1==N\)) show
28 mp_a_x mul 552 moveto (return) show
24 mp_a_x mul 540 moveto (end) show
20 mp_a_x mul 528 moveto (end) show
16 mp_a_x mul 516 moveto (end) show
12 mp_a_x mul 492 moveto (else) show
16 mp_a_x mul 480 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 468 moveto (% reject step, step unsucessful) show
16 mp_a_x mul 456 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 444 moveto (iPhase=1;) show
16 mp_a_x mul 420 moveto (%restore y,t,y_est,err1) show
16 mp_a_x mul 408 moveto (y=y\(:,1:i\);) show
16 mp_a_x mul 396 moveto (t=t\(1:i\);) show
16 mp_a_x mul 384 moveto (y_est=y_est\(:,1:i\);) show
16 mp_a_x mul 372 moveto (err2=err2\(:,1:i\);) show
16 mp_a_x mul 348 moveto (i=i-1;) show
16 mp_a_x mul 336 moveto (iNoRej=iNoRej+1;) show
16 mp_a_x mul 312 moveto (%test whether failure was due to corrector iteration  or error test failure) show
16 mp_a_x mul 300 moveto (if\(converged==0\)   % Newton iteration converged) show
20 mp_a_x mul 288 moveto (nef = nef+1;) show
20 mp_a_x mul 276 moveto (if\(nef > 1\)) show
24 mp_a_x mul 264 moveto (if\( nef > 2\)) show
28 mp_a_x mul 252 moveto (r=0.25;) show
28 mp_a_x mul 240 moveto (h\(i+1\)=r*h\(i+1\);) show
28 mp_a_x mul 228 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
32 mp_a_x mul 216 moveto (error\('minimal stepsize'\);) show
28 mp_a_x mul 204 moveto (end) show
24 mp_a_x mul 192 moveto (else % second error test failure) show
28 mp_a_x mul 180 moveto (r=0.25;) show
28 mp_a_x mul 168 moveto (h\(i+1\)=r*h\(i+1\);) show
28 mp_a_x mul 156 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
32 mp_a_x mul 144 moveto (error\('minimal stepsize'\);) show
28 mp_a_x mul 132 moveto (end) show
24 mp_a_x mul 120 moveto (end) show
20 mp_a_x mul 108 moveto (else  % first error test failure) show
24 mp_a_x mul 96 moveto (r=0.9*\(2.0*EST+0.0001\)^\(-1/\(1+1\)\);) show
24 mp_a_x mul 84 moveto (r=max\(0.25,min\(0.9,r\)\);) show
24 mp_a_x mul 72 moveto (h\(i+1\)=r*h\(i+1\);) show
24 mp_a_x mul 60 moveto (if\(abs\(h\(i+1\)\)<hmin\)) show
28 mp_a_x mul 48 moveto (error\('minimal stepsize'\);) show
24 mp_a_x mul 36 moveto (end) show
20 mp_a_x mul 24 moveto (end) show
16 mp_a_x mul 0 moveto (else % Newton iteration failed to converge) show
grestore
gsave
18 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
20 mp_a_x mul 780 moveto (nsf=nsf+1;) show
20 mp_a_x mul 768 moveto (r=0.25;) show
20 mp_a_x mul 756 moveto (h\(i+1\)=r*h\(i+1\);) show
20 mp_a_x mul 744 moveto (if\(abs\(h\(i+1\)\)<hmin || nsf >3 \)) show
24 mp_a_x mul 732 moveto (error\('minimal stepsize'\);) show
20 mp_a_x mul 720 moveto (end) show
16 mp_a_x mul 696 moveto (end) show
12 mp_a_x mul 672 moveto (end) show
8 mp_a_x mul 660 moveto (else) show
12 mp_a_x mul 648 moveto (% interpolation between meshpoints) show
12 mp_a_x mul 636 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
16 mp_a_x mul 624 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
16 mp_a_x mul 612 moveto (I=I+1;) show
12 mp_a_x mul 600 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
16 mp_a_x mul 588 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),i\);) show
16 mp_a_x mul 576 moveto (I=I+1;) show
12 mp_a_x mul 564 moveto (end) show
8 mp_a_x mul 540 moveto (end) show
4 mp_a_x mul 516 moveto (else    % constant stepsize) show
8 mp_a_x mul 504 moveto (h\(i+1\)=h\(i\);) show
8 mp_a_x mul 492 moveto (if\( i>5\)) show
12 mp_a_x mul 480 moveto (if\( err2\(:,i+1\) <= 1.0\)) show
16 mp_a_x mul 456 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 444 moveto (% step successful) show
16 mp_a_x mul 432 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 420 moveto (if\(iPhase==0\)) show
20 mp_a_x mul 408 moveto (iPhase=0;) show
20 mp_a_x mul 396 moveto (iNoRej=0;) show
16 mp_a_x mul 384 moveto (else) show
20 mp_a_x mul 372 moveto (iPhase=0;) show
16 mp_a_x mul 360 moveto (end) show
16 mp_a_x mul 336 moveto (nef=0;) show
16 mp_a_x mul 324 moveto (%ncf=0;) show
16 mp_a_x mul 312 moveto (nsf=0;) show
16 mp_a_x mul 288 moveto (% interpolation between meshpoints) show
16 mp_a_x mul 276 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
20 mp_a_x mul 264 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
20 mp_a_x mul 252 moveto (I=I+1;) show
16 mp_a_x mul 240 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
20 mp_a_x mul 228 moveto (while\(TIME\(I+1\)<t\(i+1\)\)) show
24 mp_a_x mul 216 moveto (if\(i>5\)) show
28 mp_a_x mul 204 moveto (nn=5;) show
24 mp_a_x mul 192 moveto (else) show
28 mp_a_x mul 180 moveto (nn=i;) show
24 mp_a_x mul 168 moveto (end) show
24 mp_a_x mul 156 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),nn\);) show
24 mp_a_x mul 144 moveto (I=I+1;) show
24 mp_a_x mul 132 moveto (if\(I-1==N\)) show
28 mp_a_x mul 120 moveto (return) show
24 mp_a_x mul 108 moveto (end) show
20 mp_a_x mul 96 moveto (end) show
16 mp_a_x mul 84 moveto (end) show
12 mp_a_x mul 60 moveto (else) show
16 mp_a_x mul 48 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 36 moveto (% reject step, step unsucessful) show
16 mp_a_x mul 24 moveto (%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%) show
16 mp_a_x mul 12 moveto (iPhase=1;) show
grestore
gsave
298 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
16 mp_a_x mul 780 moveto (%restore y,t,y_est,err1) show
16 mp_a_x mul 768 moveto (y=y\(:,1:i\);) show
16 mp_a_x mul 756 moveto (t=t\(1:i\);) show
16 mp_a_x mul 744 moveto (y_est=y_est\(:,1:i\);) show
16 mp_a_x mul 732 moveto (err2=err2\(:,1:i\);) show
16 mp_a_x mul 708 moveto (i=i-1;) show
16 mp_a_x mul 696 moveto (iNoRej=iNoRej+1;) show
16 mp_a_x mul 672 moveto (%test whether failure was due to corrector iteration  or error test failure) show
16 mp_a_x mul 660 moveto (if\(converged==0\)   % Newton iteration converged) show
20 mp_a_x mul 648 moveto (nef = nef+1;) show
16 mp_a_x mul 636 moveto (else % Newton iteration failed to converge) show
20 mp_a_x mul 624 moveto (nsf=nsf+1;) show
16 mp_a_x mul 612 moveto (end) show
12 mp_a_x mul 600 moveto (end) show
8 mp_a_x mul 588 moveto (else) show
12 mp_a_x mul 576 moveto (% interpolation between meshpoints) show
12 mp_a_x mul 564 moveto (if\(TIME\(I+1\)==t\(i+1\)\)) show
16 mp_a_x mul 552 moveto (y_interpol\(:,I+1\)=y\(:,i+1\);) show
16 mp_a_x mul 540 moveto (I=I+1;) show
12 mp_a_x mul 528 moveto (elseif\(TIME\(I+1\)<t\(i+1\)\)) show
16 mp_a_x mul 516 moveto (y_interpol\(:,I+1\)=interpol\(t,y,TIME\(I+1\),i\);) show
16 mp_a_x mul 504 moveto (I=I+1;) show
12 mp_a_x mul 492 moveto (end) show
8 mp_a_x mul 468 moveto (end) show
4 mp_a_x mul 456 moveto (end) show
4 mp_a_x mul 432 moveto (i=i+1;) show
0 420 moveto (end) show
0 396 moveto (::::::::::::::) show
0 384 moveto (glm_external.m) show
0 372 moveto (::::::::::::::) show
0 360 moveto (% output quantities) show
0 348 moveto (function    [y] = glm_external\( yn,Ypp,n,M,h,i,s,k \)) show
0 324 moveto (Bt = M\(2*s+1:2*s+s,1:s \);) show
0 312 moveto (Vt = M\(2*s+1:2*s+s,s+1:s+k \);) show
0 288 moveto (if\( i>1\)) show
4 mp_a_x mul 276 moveto (D = zeros\(k,k\);) show
4 mp_a_x mul 264 moveto (for j=1:k) show
8 mp_a_x mul 252 moveto (D\(j,j\)=\(h\(i\)/h\(i-1\)\)^\(j-1\);) show
4 mp_a_x mul 240 moveto (end) show
4 mp_a_x mul 216 moveto (yn = kron\(D,eye\(n,n\)\)*yn;) show
0 204 moveto (end) show
0 180 moveto (y = kron\(Vt,eye\(n,n\)\)*yn + h\(i\)^2*kron\(Bt,eye\(n,n\)\)*Ypp;) show
0 168 moveto (::::::::::::::) show
0 156 moveto (glm_internal.m) show
0 144 moveto (::::::::::::::) show
0 132 moveto (%internal stages -> Newton) show
0 120 moveto (function     [Y,dY,ddY,converged] = glm_internal\(funct,funct_d1,funct_d2,funct_d3,ddYn,y,n,M,c,h,j,t,s,k,RTOL,ATOL,start\)) show
0 96 moveto (At = M\(1:s,1:s\);) show
0 84 moveto (Ut = M\(1:s,s+1:s+k\);) show
0 72 moveto (A  = M\(s+1:s+s,1:s\);) show
0 60 moveto (U  = M\(s+1:s+s,s+1:s+k\); ) show
0 36 moveto (%starting value for Newton-Iteration) show
0 24 moveto (Y0 = ddYn;) show
0 0 moveto (% maximal number of iterations) show
grestore
gsave
298 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
0 780 moveto (MAXIT = 20;) show
0 756 moveto (x\(:,1\)=Y0;   ) show
0 744 moveto (dx\(:,1\)=Y0;) show
0 732 moveto (abbruch=1;) show
0 708 moveto (if\( j>1\)) show
4 mp_a_x mul 696 moveto (D = zeros\(k,k\);) show
4 mp_a_x mul 684 moveto (for jj=1:k) show
8 mp_a_x mul 672 moveto (D\(jj,jj\)=\(h\(j\)/h\(j-1\)\)^\(jj-1\);) show
4 mp_a_x mul 660 moveto (end) show
4 mp_a_x mul 648 moveto (y=kron\(D,eye\(n,n\)\)*y;) show
0 636 moveto (end) show
0 612 moveto (% Iteration counter) show
0 600 moveto (m=1; ) show
0 576 moveto (while\(abbruch >= 0.33 && m<=MAXIT\)) show
4 mp_a_x mul 552 moveto (ddY = x\(:,m\);) show
4 mp_a_x mul 528 moveto (Y  = kron\(Ut,eye\(n,n\)\)*y + h\(j\)^2*kron\(At,eye\(n,n\)\)*ddY;) show
4 mp_a_x mul 516 moveto (dY = kron\(U,eye\(n,n\)\)*y  + h\(j\)*kron\(A,eye\(n,n\)\)*ddY;   ) show
4 mp_a_x mul 492 moveto (for i=1:s) show
7 mp_a_x mul 480 moveto (J\(n*\(i-1\)+1:n*i,n*\(i-1\)+1:n*i\) = feval\(funct_d1,t+c\(i\)*h\(j\),Y\(n*\(i-1\)+1:n*i\),dY\(n*\(i-1\)+1:n*i\),ddY\(n*\(i-1\)+1:n*i\)\);) show
7 mp_a_x mul 468 moveto (K\(n*\(i-1\)+1:n*i,n*\(i-1\)+1:n*i\) = feval\(funct_d2,t+c\(i\)*h\(j\),Y\(n*\(i-1\)+1:n*i\),dY\(n*\(i-1\)+1:n*i\),ddY\(n*\(i-1\)+1:n*i\),'glm'\);) show
7 mp_a_x mul 456 moveto (L\(n*\(i-1\)+1:n*i,n*\(i-1\)+1:n*i\) = feval\(funct_d3,t+c\(i\)*h\(j\),Y\(n*\(i-1\)+1:n*i\),dY\(n*\(i-1\)+1:n*i\),ddY\(n*\(i-1\)+1:n*i\),'glm'\);) show
4 mp_a_x mul 444 moveto (end) show
4 mp_a_x mul 420 moveto (for i=1:s) show
8 mp_a_x mul 408 moveto (F\(n*\(i-1\)+1:n*i,1\)  = feval\( funct,t+c\(i\)*h\(j\),Y\(n*\(i-1\)+1:n*i\),dY\(n*\(i-1\)+1:n*i\),ddY\(n*\(i-1\)+1:n*i\)\);) show
4 mp_a_x mul 396 moveto (end) show
4 mp_a_x mul 372 moveto (DF = L + h\(j\)^2*kron\(At,eye\(n,n\)\)*J + h\(j\)*kron\(A,eye\(n,n\)\)*K; ) show
4 mp_a_x mul 348 moveto (DF=1/\(h\(1\)^2\)*DF;) show
4 mp_a_x mul 336 moveto (F=1/\(h\(1\)^2\)*F;) show
4 mp_a_x mul 312 moveto ([LL,UU,PP]=lu\(DF\);) show
4 mp_a_x mul 300 moveto (f_neu=-PP*F;) show
4 mp_a_x mul 288 moveto (yy = forward\(LL,f_neu\);) show
4 mp_a_x mul 276 moveto (if\(start == 1\)) show
8 mp_a_x mul 264 moveto (z1 = backward\(UU,yy,1\);) show
4 mp_a_x mul 252 moveto (else) show
8 mp_a_x mul 240 moveto (z1 = backward\(UU,yy\);) show
4 mp_a_x mul 228 moveto (end) show
4 mp_a_x mul 204 moveto (dx\(:,m+1\)=z1;) show
4 mp_a_x mul 192 moveto (x\(:,m+1\)=x\(:,m\)+dx\(:,m+1\);) show
4 mp_a_x mul 168 moveto (m=m+1;) show
4 mp_a_x mul 156 moveto (if\(m>2\)) show
8 mp_a_x mul 144 moveto (rho = \(myNorm\(x\(:,m\)-x\(:,m-1\),RTOL,ATOL\)/myNorm\(x\(:,2\)-x\(:,1\),RTOL,ATOL\)\)^\(1/\(m-1\)\);) show
8 mp_a_x mul 132 moveto (abbruch = rho/\(1-rho\)*myNorm\(x\(:,m\)-x\(:,m-1\),RTOL,ATOL\);) show
4 mp_a_x mul 120 moveto (end) show
0 108 moveto (end % end while) show
0 84 moveto (if\(m<MAXIT\)) show
4 mp_a_x mul 72 moveto (converged = 0;) show
0 60 moveto (else) show
4 mp_a_x mul 48 moveto (converged = 1;) show
0 36 moveto (end) show
0 12 moveto (ddY = x\(:,m\);) show
grestore
restore
showpage
%%Page: 6 6
save
0 setlinewidth
18 18 moveto 0 806 rlineto
560 0 rlineto 0 -806 rlineto closepath stroke
18 421 moveto 560 0 rlineto stroke
298 18 moveto 0 806 rlineto stroke
gsave
18 421 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
0 780 moveto (::::::::::::::) show
0 768 moveto (starting.m) show
0 756 moveto (::::::::::::::) show
0 732 moveto (function [y] = starting\(funct,funct_d1,funct_d2,funct_d3,n,p,q,s,h,t0,y0,y1,RTOL,ATOL\)) show
5 mp_a_x mul 708 moveto (Y   = kron\(ones\(s,1\),eye\(n,n\)\)*y0;) show
5 mp_a_x mul 696 moveto (dY  = kron\(ones\(s,1\),eye\(n,n\)\)*y1;) show
5 mp_a_x mul 684 moveto (ddY = kron\(ones\(s,1\),eye\(n,n\)\)*y1;) show
5 mp_a_x mul 648 moveto (y\(1:n,1\)=y0;) show
5 mp_a_x mul 636 moveto (y\(n+1:2*n,1\)=h*y1;) show
5 mp_a_x mul 612 moveto (c = 0:1/p:1;) show
5 mp_a_x mul 588 moveto ([S] = startProc\(p,c,h\);) show
5 mp_a_x mul 564 moveto (%internal stages -> Newton) show
5 mp_a_x mul 552 moveto ([Y,dY,ddY]= glm_internal\(funct,funct_d1,funct_d2,funct_d3,Y,dY,ddY,y,n,S,c,h,1,t0,p,q,s,2,RTOL,ATOL,1 \); ) show
4 mp_a_x mul 528 moveto (% output quantities) show
5 mp_a_x mul 516 moveto ([y] =  glm_external\(funct,t0,y, ddY,n,S,c,h,1,p,q,s,2 \); ) show
0 504 moveto (::::::::::::::) show
0 492 moveto (startProc.m) show
0 480 moveto (::::::::::::::) show
0 468 moveto (% Starting procedure) show
0 456 moveto (%) show
0 444 moveto (% p order of method) show
0 432 moveto (% c vector of abscissae of lenght p+1) show
0 420 moveto (function [S] = startProc\(p,c,h\)) show
0 396 moveto (% ) show
0 384 moveto (% if\( length\(c\) ~= p+1\)) show
0 372 moveto (%     error\('wrong input'\);) show
0 360 moveto (% end) show
0 348 moveto (% ) show
0 336 moveto (% J = zeros\(p+1,p+1\);) show
0 324 moveto (% C = zeros\(p+1,p+1\);) show
0 312 moveto (% M = zeros\(p+1,p+1\);) show
0 300 moveto (% for i=1:p+1) show
0 288 moveto (%     for j=1:p+1) show
0 276 moveto (%         if\( i == j+1\)) show
0 264 moveto (%             J\(i,j\)=1;) show
0 252 moveto (%         end) show
0 240 moveto (%         if\( i == j+2\)) show
0 228 moveto (%             M\(i,j\)=1;) show
0 216 moveto (%         end) show
0 204 moveto (%         if j==1) show
0 192 moveto (%             C\(i,j\)=1;) show
0 180 moveto (%         else) show
0 168 moveto (%             C\(i,j\)=c\(i\)^\(j-1\)/faculty\(j-1\);) show
0 156 moveto (%         end) show
0 144 moveto (%     end) show
0 132 moveto (% end) show
0 120 moveto (% ) show
0 108 moveto (% At = C*M*inv\(C\);) show
0 96 moveto (% Bt = M*inv\(C\);) show
0 84 moveto (% A = C*J*inv\(C\);) show
0 72 moveto (% ) show
0 60 moveto (% Ut\(:,1\) = ones\(p+1,1\);) show
0 48 moveto (% Ut\(:,2\) = c';) show
0 36 moveto (% ) show
0 24 moveto (% Vt = zeros\(p+1,2\);) show
0 12 moveto (% Vt\(1:2,1:2\) = eye\(2,2\);) show
0 0 moveto (% ) show
grestore
gsave
18 18 translate
0 0 moveto 0 403 rlineto 280 0 rlineto 0 -403 rlineto closepath clip
280 80 mp_a_x mul div 403 792 div scale
4 7 translate 272 280 div 784 792 div scale
textfont setfont
0 780 moveto (% U = zeros\(p+1,2\);) show
0 768 moveto (% U\(:,2\) = 1/h*ones\(p+1,1\);) show
0 756 moveto (% ) show
0 744 moveto (% S = [ At Ut) show
0 732 moveto (%       A  U) show
0 720 moveto (%       Bt  Vt];) show
0 684 moveto (s = p+1;) show
0 660 moveto (%if\( length\(c\) ~= s\)) show
0 648 moveto (%    error\('wrong input'\);) show
0 636 moveto (%end) show
0 612 moveto (J = zeros\(s,s\);) show
0 600 moveto (C = zeros\(s,s\);) show
0 588 moveto (M = zeros\(s,s\);) show
0 576 moveto (for i=1:s) show
4 mp_a_x mul 564 moveto (for j=1:s) show
8 mp_a_x mul 552 moveto (if\( i == j+1\)) show
12 mp_a_x mul 540 moveto (J\(i,j\)=1;) show
8 mp_a_x mul 528 moveto (end) show
8 mp_a_x mul 516 moveto (if\( i == j+2\)) show
12 mp_a_x mul 504 moveto (M\(i,j\)=1;) show
8 mp_a_x mul 492 moveto (end) show
8 mp_a_x mul 480 moveto (if j==1) show
12 mp_a_x mul 468 moveto (C\(i,j\)=1;) show
8 mp_a_x mul 456 moveto (else) show
12 mp_a_x mul 444 moveto (C\(i,j\)=c\(i\)^\(j-1\)/faculty\(j-1\);) show
8 mp_a_x mul 432 moveto (end) show
4 mp_a_x mul 420 moveto (end) show
0 408 moveto (end) show
0 384 moveto (At = C*M*inv\(C\);) show
0 372 moveto (Bt = M*inv\(C\);) show
0 360 moveto (A = C*J*inv\(C\);) show
0 336 moveto (Ut\(:,1\) = ones\(s,1\);) show
0 324 moveto (Ut\(:,2\) = c';) show
0 300 moveto (Vt = zeros\(s,2\);) show
0 288 moveto (Vt\(1:2,1:2\) = eye\(2,2\);) show
0 264 moveto (U = zeros\(s,2\);) show
0 252 moveto (U\(:,2\) = 1/h*ones\(s,1\);) show
0 228 moveto (S = [ At Ut) show
6 mp_a_x mul 216 moveto (A  U) show
grestore
restore
showpage
%%Trailer
%%Pages: 6
